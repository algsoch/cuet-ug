<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DU Admission Analyzer - Interactive Dashboard</title>
    
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary-color: #3b82f6;
            --secondary-color: #1e40af;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --dark-color: #1f2937;
            --light-color: #f8fafc;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .dashboard-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            margin: 20px;
            padding: 30px;
            min-height: 90vh;
        }

        .header-section {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            text-align: center;
        }

        .stats-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .stats-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
        }

        .stats-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }

        .stats-number {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .chart-container {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e5e7eb;
        }

        .play-button {
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(59, 130, 246, 0.3);
        }

        .play-button:hover {
            background: var(--secondary-color);
            transform: scale(1.1);
            box-shadow: 0 8px 20px rgba(59, 130, 246, 0.4);
        }

        .play-button:disabled {
            background: #6b7280;
            cursor: not-allowed;
            transform: none;
        }

        .search-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }

        .search-input {
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            padding: 15px 20px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .search-input:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .filter-buttons {
            gap: 10px;
            margin-top: 15px;
        }

        .filter-btn {
            border: 2px solid var(--primary-color);
            color: var(--primary-color);
            background: transparent;
            border-radius: 25px;
            padding: 8px 20px;
            transition: all 0.3s ease;
        }

        .filter-btn.active, .filter-btn:hover {
            background: var(--primary-color);
            color: white;
        }

        .loading-spinner {
            display: none;
            text-align: center;
            padding: 50px;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #e5e7eb;
            border-top: 5px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .data-table {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            margin-top: 30px;
        }

        .table {
            border-radius: 10px;
            overflow: hidden;
        }

        .table thead th {
            background: var(--primary-color);
            color: white;
            border: none;
            font-weight: 600;
            padding: 15px;
        }

        .table tbody td {
            padding: 12px 15px;
            border-bottom: 1px solid #e5e7eb;
        }

        .table tbody tr:hover {
            background: #f8fafc;
        }

        .error-message {
            background: #fee2e2;
            color: #dc2626;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 5px solid #dc2626;
        }

        @media (max-width: 768px) {
            .dashboard-container {
                margin: 10px;
                padding: 20px;
            }
            
            .header-section {
                padding: 20px;
            }
            
            .stats-card {
                text-align: center;
            }
            
            .chart-header {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- Header Section -->
        <div class="header-section">
            <h1 class="mb-3"><i class="fas fa-graduation-cap me-3"></i>DU Admission Analyzer</h1>
            <p class="mb-0">Interactive Dashboard for Delhi University Admission Analysis</p>
        </div>

        <!-- Loading Spinner -->
        <div id="loadingSpinner" class="loading-spinner">
            <div class="spinner mx-auto mb-3"></div>
            <p>Loading dashboard data...</p>
        </div>

        <!-- Error Message -->
        <div id="errorMessage" class="error-message" style="display: none;">
            <i class="fas fa-exclamation-triangle me-2"></i>
            <span id="errorText">Unable to load data. Please refresh the page.</span>
        </div>

        <!-- Main Dashboard Content -->
        <div id="dashboardContent" style="display: none;">
            <!-- Statistics Cards -->
            <div class="row mb-4">
                <div class="col-md-3 col-sm-6">
                    <div class="stats-card text-center">
                        <div class="stats-icon text-primary">
                            <i class="fas fa-university"></i>
                        </div>
                        <div class="stats-number text-primary" id="totalColleges">0</div>
                        <div class="text-muted">Total Colleges</div>
                    </div>
                </div>
                <div class="col-md-3 col-sm-6">
                    <div class="stats-card text-center">
                        <div class="stats-icon text-success">
                            <i class="fas fa-book"></i>
                        </div>
                        <div class="stats-number text-success" id="totalPrograms">0</div>
                        <div class="text-muted">Total Programs</div>
                    </div>
                </div>
                <div class="col-md-3 col-sm-6">
                    <div class="stats-card text-center">
                        <div class="stats-icon text-warning">
                            <i class="fas fa-chair"></i>
                        </div>
                        <div class="stats-number text-warning" id="totalSeats">0</div>
                        <div class="text-muted">Total Seats</div>
                    </div>
                </div>
                <div class="col-md-3 col-sm-6">
                    <div class="stats-card text-center">
                        <div class="stats-icon text-info">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="stats-number text-info" id="avgSeats">0</div>
                        <div class="text-muted">Avg Seats/Program</div>
                    </div>
                </div>
            </div>

            <!-- Search and Filter Section -->
            <div class="search-section">
                <h4 class="mb-3"><i class="fas fa-search me-2"></i>Search & Filter</h4>
                <div class="row">
                    <div class="col-md-8">
                        <input type="text" id="searchInput" class="form-control search-input" 
                               placeholder="Search colleges, programs, or any keyword...">
                    </div>
                    <div class="col-md-4">
                        <select id="categoryFilter" class="form-select search-input">
                            <option value="">All Categories</option>
                            <option value="UR">UR (Unreserved)</option>
                            <option value="OBC">OBC</option>
                            <option value="SC">SC</option>
                            <option value="ST">ST</option>
                            <option value="EWS">EWS</option>
                            <option value="SIKH">SIKH</option>
                            <option value="PwBD">PwBD</option>
                        </select>
                    </div>
                </div>
                <div class="filter-buttons d-flex flex-wrap">
                    <button class="btn filter-btn active" onclick="filterByType('all')">All</button>
                    <button class="btn filter-btn" onclick="filterByType('bcom')">B.Com</button>
                    <button class="btn filter-btn" onclick="filterByType('bsc')">B.Sc</button>
                    <button class="btn filter-btn" onclick="filterByType('ba')">B.A</button>
                    <button class="btn filter-btn" onclick="filterByType('honours')">Honours</button>
                    <button class="btn filter-btn" onclick="filterByType('program')">Program</button>
                </div>
            </div>

            <!-- Charts Section -->
            <div class="row">
                <!-- College Distribution Chart -->
                <div class="col-lg-6">
                    <div class="chart-container">
                        <div class="chart-header">
                            <h5><i class="fas fa-chart-bar me-2"></i>Top Colleges by Available Seats</h5>
                            <button class="play-button" id="collegeChartBtn" onclick="renderCollegeChart()">
                                <i class="fas fa-play"></i>
                            </button>
                        </div>
                        <canvas id="collegeChart" width="400" height="300"></canvas>
                    </div>
                </div>

                <!-- Program Distribution Chart -->
                <div class="col-lg-6">
                    <div class="chart-container">
                        <div class="chart-header">
                            <h5><i class="fas fa-chart-pie me-2"></i>Program Categories Distribution</h5>
                            <button class="play-button" id="programChartBtn" onclick="renderProgramChart()">
                                <i class="fas fa-play"></i>
                            </button>
                        </div>
                        <canvas id="programChart" width="400" height="300"></canvas>
                    </div>
                </div>
            </div>

            <div class="row">
                <!-- Category Wise Distribution -->
                <div class="col-lg-6">
                    <div class="chart-container">
                        <div class="chart-header">
                            <h5><i class="fas fa-chart-donut me-2"></i>Category-wise Seat Distribution</h5>
                            <button class="play-button" id="categoryChartBtn" onclick="renderCategoryChart()">
                                <i class="fas fa-play"></i>
                            </button>
                        </div>
                        <canvas id="categoryChart" width="400" height="300"></canvas>
                    </div>
                </div>

                <!-- Trend Analysis -->
                <div class="col-lg-6">
                    <div class="chart-container">
                        <div class="chart-header">
                            <h5><i class="fas fa-chart-line me-2"></i>Seat Availability Trend</h5>
                            <button class="play-button" id="trendChartBtn" onclick="renderTrendChart()">
                                <i class="fas fa-play"></i>
                            </button>
                        </div>
                        <canvas id="trendChart" width="400" height="300"></canvas>
                    </div>
                </div>
            </div>

            <!-- Data Table -->
            <div class="data-table">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h5><i class="fas fa-table me-2"></i>Admission Data</h5>
                    <div>
                        <span class="badge bg-primary" id="resultCount">0 results</span>
                        <button class="btn btn-success btn-sm ms-2" onclick="exportToExcel()">
                            <i class="fas fa-download me-1"></i>Export Excel
                        </button>
                    </div>
                </div>
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>S.No</th>
                                <th>College</th>
                                <th>Program</th>
                                <th>UR</th>
                                <th>OBC</th>
                                <th>SC</th>
                                <th>ST</th>
                                <th>EWS</th>
                                <th>SIKH</th>
                                <th>PwBD</th>
                                <th>Total</th>
                            </tr>
                        </thead>
                        <tbody id="dataTableBody">
                            <!-- Data will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Application JavaScript -->
    <script>
        // Global variables
        let admissionData = [];
        let chartData = {};
        let charts = {};
        
        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🚀 Initializing DU Admission Analyzer Dashboard');
            loadDashboardData();
            setupEventListeners();
        });

        // Setup event listeners
        function setupEventListeners() {
            const searchInput = document.getElementById('searchInput');
            const categoryFilter = document.getElementById('categoryFilter');
            
            searchInput.addEventListener('input', debounce(filterData, 300));
            categoryFilter.addEventListener('change', filterData);
        }

        // Debounce function for search
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Load dashboard data
        async function loadDashboardData() {
            showLoading(true);
            
            try {
                console.log('📊 Loading chart data...');
                const chartResponse = await fetch('/api/chart-data');
                if (!chartResponse.ok) {
                    throw new Error(`Chart API error: ${chartResponse.status}`);
                }
                chartData = await chartResponse.json();
                console.log('✅ Chart data loaded:', chartData);

                console.log('📋 Loading raw data...');
                const dataResponse = await fetch('/api/data');
                if (!dataResponse.ok) {
                    throw new Error(`Data API error: ${dataResponse.status}`);
                }
                admissionData = await dataResponse.json();
                console.log('✅ Raw data loaded:', admissionData.length, 'records');

                // Update dashboard
                updateStatistics();
                populateDataTable(admissionData);
                showDashboard();
                
            } catch (error) {
                console.error('❌ Error loading dashboard data:', error);
                showError(`Failed to load data: ${error.message}`);
            } finally {
                showLoading(false);
            }
        }

        // Update statistics cards
        function updateStatistics() {
            if (!chartData.summary_cards) {
                console.warn('⚠️ No summary data available');
                return;
            }

            const stats = chartData.summary_cards;
            
            document.getElementById('totalColleges').textContent = stats.total_colleges || 0;
            document.getElementById('totalPrograms').textContent = stats.total_programs || 0;
            document.getElementById('totalSeats').textContent = stats.total_seats || 0;
            document.getElementById('avgSeats').textContent = Math.round(stats.avg_seats_per_program || 0);
            
            console.log('📊 Statistics updated:', stats);
        }

        // Render college chart
        function renderCollegeChart() {
            const btn = document.getElementById('collegeChartBtn');
            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';

            setTimeout(() => {
                try {
                    const ctx = document.getElementById('collegeChart').getContext('2d');
                    
                    if (charts.college) {
                        charts.college.destroy();
                    }

                    const collegeData = chartData.college_bar || { labels: [], datasets: [] };
                    
                    charts.college = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: collegeData.labels || [],
                            datasets: [{
                                label: 'Available Seats',
                                data: collegeData.data || [],
                                backgroundColor: 'rgba(59, 130, 246, 0.8)',
                                borderColor: 'rgba(59, 130, 246, 1)',
                                borderWidth: 2,
                                borderRadius: 8
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    display: false
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    grid: {
                                        color: 'rgba(0, 0, 0, 0.1)'
                                    }
                                },
                                x: {
                                    grid: {
                                        display: false
                                    }
                                }
                            }
                        }
                    });

                    console.log('📊 College chart rendered');
                    btn.innerHTML = '<i class="fas fa-check"></i>';
                    btn.style.background = '#10b981';
                    
                } catch (error) {
                    console.error('❌ Error rendering college chart:', error);
                    btn.innerHTML = '<i class="fas fa-exclamation"></i>';
                    btn.style.background = '#ef4444';
                }
            }, 500);
        }

        // Render program chart
        function renderProgramChart() {
            const btn = document.getElementById('programChartBtn');
            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';

            setTimeout(() => {
                try {
                    const ctx = document.getElementById('programChart').getContext('2d');
                    
                    if (charts.program) {
                        charts.program.destroy();
                    }

                    const programData = chartData.program_pie || { labels: [], datasets: [] };
                    
                    charts.program = new Chart(ctx, {
                        type: 'doughnut',
                        data: {
                            labels: programData.labels || [],
                            datasets: [{
                                data: programData.data || [],
                                backgroundColor: [
                                    '#3b82f6', '#10b981', '#f59e0b', '#ef4444',
                                    '#8b5cf6', '#06b6d4', '#84cc16', '#f97316'
                                ],
                                borderWidth: 2,
                                borderColor: '#ffffff'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom'
                                }
                            }
                        }
                    });

                    console.log('🥧 Program chart rendered');
                    btn.innerHTML = '<i class="fas fa-check"></i>';
                    btn.style.background = '#10b981';
                    
                } catch (error) {
                    console.error('❌ Error rendering program chart:', error);
                    btn.innerHTML = '<i class="fas fa-exclamation"></i>';
                    btn.style.background = '#ef4444';
                }
            }, 500);
        }

        // Render category chart
        function renderCategoryChart() {
            const btn = document.getElementById('categoryChartBtn');
            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';

            setTimeout(() => {
                try {
                    const ctx = document.getElementById('categoryChart').getContext('2d');
                    
                    if (charts.category) {
                        charts.category.destroy();
                    }

                    const categoryData = chartData.category_pie || { labels: [], datasets: [] };
                    
                    charts.category = new Chart(ctx, {
                        type: 'pie',
                        data: {
                            labels: categoryData.labels || [],
                            datasets: [{
                                data: categoryData.data || [],
                                backgroundColor: [
                                    '#3b82f6', '#10b981', '#f59e0b', '#ef4444',
                                    '#8b5cf6', '#06b6d4', '#84cc16'
                                ],
                                borderWidth: 2,
                                borderColor: '#ffffff'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom'
                                }
                            }
                        }
                    });

                    console.log('📊 Category chart rendered');
                    btn.innerHTML = '<i class="fas fa-check"></i>';
                    btn.style.background = '#10b981';
                    
                } catch (error) {
                    console.error('❌ Error rendering category chart:', error);
                    btn.innerHTML = '<i class="fas fa-exclamation"></i>';
                    btn.style.background = '#ef4444';
                }
            }, 500);
        }

        // Render trend chart
        function renderTrendChart() {
            const btn = document.getElementById('trendChartBtn');
            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';

            setTimeout(() => {
                try {
                    const ctx = document.getElementById('trendChart').getContext('2d');
                    
                    if (charts.trend) {
                        charts.trend.destroy();
                    }

                    const trendData = chartData.trend_line || { labels: [], datasets: [] };
                    
                    charts.trend = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: trendData.labels || [],
                            datasets: [{
                                label: 'Seat Distribution',
                                data: trendData.data || [],
                                borderColor: '#3b82f6',
                                backgroundColor: 'rgba(59, 130, 246, 0.1)',
                                borderWidth: 3,
                                fill: true,
                                tension: 0.4
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    display: false
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    grid: {
                                        color: 'rgba(0, 0, 0, 0.1)'
                                    }
                                },
                                x: {
                                    grid: {
                                        display: false
                                    }
                                }
                            }
                        }
                    });

                    console.log('📈 Trend chart rendered');
                    btn.innerHTML = '<i class="fas fa-check"></i>';
                    btn.style.background = '#10b981';
                    
                } catch (error) {
                    console.error('❌ Error rendering trend chart:', error);
                    btn.innerHTML = '<i class="fas fa-exclamation"></i>';
                    btn.style.background = '#ef4444';
                }
            }, 500);
        }

        // Filter data based on search and category
        function filterData() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const category = document.getElementById('categoryFilter').value;
            
            let filteredData = admissionData;

            if (searchTerm) {
                filteredData = filteredData.filter(row => 
                    (row[1] && row[1].toLowerCase().includes(searchTerm)) ||
                    (row[2] && row[2].toLowerCase().includes(searchTerm))
                );
            }

            if (category) {
                const categoryIndex = getCategoryIndex(category);
                if (categoryIndex > 0) {
                    filteredData = filteredData.filter(row => 
                        row[categoryIndex] && parseInt(row[categoryIndex]) > 0
                    );
                }
            }

            populateDataTable(filteredData);
        }

        // Filter by program type
        function filterByType(type) {
            // Update active button
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            let filteredData = admissionData;

            if (type !== 'all') {
                filteredData = filteredData.filter(row => {
                    const program = (row[2] || '').toLowerCase();
                    
                    switch(type) {
                        case 'bcom': return program.includes('b.com');
                        case 'bsc': return program.includes('b.sc');
                        case 'ba': return program.includes('b.a');
                        case 'honours': return program.includes('hons');
                        case 'program': return program.includes('program');
                        default: return true;
                    }
                });
            }

            populateDataTable(filteredData);
        }

        // Get category column index
        function getCategoryIndex(category) {
            const categoryMap = {
                'UR': 3, 'OBC': 4, 'SC': 5, 'ST': 6, 
                'EWS': 7, 'SIKH': 8, 'PwBD': 9
            };
            return categoryMap[category] || 0;
        }

        // Populate data table
        function populateDataTable(data) {
            const tbody = document.getElementById('dataTableBody');
            const resultCount = document.getElementById('resultCount');
            
            tbody.innerHTML = '';
            resultCount.textContent = `${data.length} results`;

            data.slice(0, 100).forEach((row, index) => {
                const tr = document.createElement('tr');
                
                // Calculate total seats
                const total = (parseInt(row[3]) || 0) + (parseInt(row[4]) || 0) + 
                            (parseInt(row[5]) || 0) + (parseInt(row[6]) || 0) + 
                            (parseInt(row[7]) || 0) + (parseInt(row[8]) || 0) + 
                            (parseInt(row[9]) || 0);
                
                tr.innerHTML = `
                    <td>${row[0] || index + 1}</td>
                    <td><strong>${row[1] || 'N/A'}</strong></td>
                    <td>${row[2] || 'N/A'}</td>
                    <td><span class="badge bg-primary">${row[3] || 0}</span></td>
                    <td><span class="badge bg-success">${row[4] || 0}</span></td>
                    <td><span class="badge bg-info">${row[5] || 0}</span></td>
                    <td><span class="badge bg-warning">${row[6] || 0}</span></td>
                    <td><span class="badge bg-secondary">${row[7] || 0}</span></td>
                    <td><span class="badge bg-dark">${row[8] || 0}</span></td>
                    <td><span class="badge bg-danger">${row[9] || 0}</span></td>
                    <td><strong><span class="badge bg-primary">${total}</span></strong></td>
                `;
                
                tbody.appendChild(tr);
            });

            if (data.length > 100) {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td colspan="11" class="text-center text-muted">
                        <i class="fas fa-info-circle me-2"></i>
                        Showing first 100 results of ${data.length} total records
                    </td>
                `;
                tbody.appendChild(tr);
            }

            console.log(`📋 Table updated with ${data.length} records`);
        }

        // Export to Excel
        function exportToExcel() {
            window.open('/api/download/excel', '_blank');
        }

        // Show/hide loading spinner
        function showLoading(show) {
            document.getElementById('loadingSpinner').style.display = show ? 'block' : 'none';
        }

        // Show/hide dashboard content
        function showDashboard() {
            document.getElementById('dashboardContent').style.display = 'block';
        }

        // Show error message
        function showError(message) {
            document.getElementById('errorText').textContent = message;
            document.getElementById('errorMessage').style.display = 'block';
        }

        // Console welcome message
        console.log(`
        🎓 DU Admission Analyzer Dashboard
        ================================
        📊 Interactive Charts & Analytics
        🔍 Advanced Search & Filtering  
        📱 Mobile Responsive Design
        ⚡ Real-time Data Processing
        
        API Status: Ready
        Data Processing: Complete
        Charts: Interactive
        `);
    </script>
</body>
</html>
